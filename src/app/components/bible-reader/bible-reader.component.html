@if (book) {
  <div class="text-container" unifiedGestures (swipeLeft)="goToNextChapter()" (swipeRight)="goToPreviousChapter()">
    <header class="reader-header" [book]="book" [chapterNumber]="chapterNumber" (openBookSelector)="openBookDrawer($event)" (openChapterSelector)="openChapterDrawer($event)"></header>
    <mat-drawer-container class="bookSelectorContainer" #container>
      @if (getBooks()) {
        <mat-drawer class="bookSelector" mode="over" position="start" #bookDrawer closed>
          <button matIconButton (click)="dismissBookDrawer()" class="dismiss-button" #bookDrawerCloseButton>
            <mat-icon>menu_open</mat-icon>
          </button>
          @if(showBooks){
            <book-selector [books]="getBooks()" (submitData)="onBookSubmit($event)"></book-selector>
          }
          @else{
          <chapter-selector [chapters]="book.chapters || []" [selectedChapter]="chapterNumber" (submitData)="onChapterSubmit($event)"></chapter-selector>
        }
      </mat-drawer>
    }
    <mat-drawer-content
      style="background-color: var(--background-color)"
      (scroll)="dismissSelectionMenu()">
      <div style="margin: 8px 8px 0px 8px;">
        <div class="bookBlock" [ngClass]="{'largeBook': book.id==='about'}">
          @if (chapter) {
            <div pinch-to-zoom class="chapterBlock" #readerContent>
              @if(book.id !== 'about'){
                @for (verse of chapter.verses; track verse) {
                  <verse [id]="verse.number" class="verse" [data]="verse"></verse>
                }
              }
              @if (book.id==='about') {
                <about></about>
              }
              <br><br>
              <span class="center"><b>© DIFUSORA BÍBLICA</b></span>
              <span class="center">
                Reservados todos os direitos. É proibida a reprodução, total ou parcial, do texto, sem autorização, por
              escrito, da Editora.</span>
            </div>
          }
          @if (scrolled) {
            <div style="height: 64px;"></div>
          }
        </div>
      </div>
      @if (selectionMenuVisible) {
        <div
          class="selection-menu"
          [class.bottom]="selectionMenuPlacement === 'bottom'"
          [style.left.px]="selectionMenuPosition.x"
          [style.top.px]="selectionMenuPosition.y">
          <button type="button" class="selection-menu-button" (click)="copySelection()">
            Copiar
          </button>
          <span class="selection-menu-divider"></span>
          @if (selectionHasHighlight) {
            <button type="button" class="selection-menu-button" (click)="removeHighlightSelection()">
              Remover realce
            </button>
          } @else {
            <button type="button" class="selection-menu-button" (click)="highlightSelection()">
              Realçar
            </button>
          }
          <span class="selection-menu-divider"></span>
          <button type="button" class="selection-menu-button" (click)="addNote()">
            Nota
          </button>
          @if (shareAvailable) {
            <span class="selection-menu-divider"></span>
            <button type="button" class="selection-menu-button" (click)="shareSelection()">
              Partilhar
            </button>
          }
        </div>
      }
      @if (book.id !== 'about') {
        <!-- Floating navigation buttons -->
        @if (chapter.number > 1) {
          <button class="floating-nav-button prev-chapter"
            mat-mini-fab aria-label="Previous chapter"
            (click)="goToPreviousChapter()">
            <mat-icon>chevron_left</mat-icon>
          </button>
        }
        @if (  chapter.number < book.chapterCount) {
          <button class="floating-nav-button next-chapter"
            mat-mini-fab aria-label="Next chapter"
            (click)="goToNextChapter()">
            <mat-icon>chevron_right</mat-icon>
          </button>
        }
      }
    </mat-drawer-content>
  </mat-drawer-container>
</div>
}
