<ng-container *ngIf="data">
  <!-- Verse Number -->
   @if(data.number > 0){
  <span class="verseNumber">
    {{ data.number }}
  </span>
}

  <!-- Text Content Loop -->
  <ng-container *ngFor="let text of data.text; let i = index; let isFirst = first; let isLast = last">
    
    <!-- Chapter Number Display -->
    <div *ngIf="shouldDisplayChapterNumber(data, text, i, isLast)" class="chapterNumber">
      {{ data.chapterNumber }}
    </div>

    <!-- Main Verse Text Content -->
    <span class="verseText">
      <ng-container *ngIf="!isInSection(data.text, i)">
        
        <!-- Regular Text -->
        @if(text.type === 'text'){
        <span [ngClass]="{'allCaps': text.allCaps}">
          {{ text.text }}
        </span>
      }
        <!-- References -->
    @if(text.type === "references"){
      <span class="references">
        <span>{{ " " }}</span>
        <h3>
        @for(part of parseReferences(text.text).parts; track $index){
          @if(typeof part === "object" && part.book !== data.bookId){
            <a class="references"
              [routerLink]="['/', (part.book | lowercase ), part.chapter]"
              [queryParams]="getVerseQueryParams(part.verses)"
              >{{part.match}}</a
            >
        } @else {
          <span class="references">{{typeof part === "object" ? part.match : part}}</span>
        }
      }
        </h3>
      </span>
    }

        <!-- Paragraph Breaks -->
        <div *ngIf="text.type === 'paragraph' && data.verseLabel !== 'front'"></div>
        <div *ngIf="isLast && text.type === 'quote'"></div>

        <!-- Complex Paragraph Logic -->
        <ng-container *ngIf="text.type === 'paragraph'">
          <!-- First Case: Last paragraph with specific conditions -->
          <span *ngIf="!isFirst && isLast && chapterNumberIndex !== i && !shouldShowParagraph(data, text, i)">
            <div></div>
            <span #paragraph [ngClass]="{'indent': !checkIfIsTouchingChapterNumber(paragraph)}">
              {{ text.text }}
            </span>
          </span>

          <!-- Second Case: Regular paragraph with complex conditions -->
          <span #paragraph *ngIf="shouldShowParagraph(data, text, i)" [ngClass]="{'indent': !checkIfIsTouchingChapterNumber(paragraph)}">
            {{ text.text }}
          </span>
        </ng-container>

        <!-- Section Headers -->
        <ng-container *ngIf="text.type === 'section'">
          <!-- Main Section (s1 or ms) -->
          <ng-container *ngIf="text.tag === 's1' || text.tag === 'ms'">
            <p></p>
            <h3>{{ text.text }}</h3>
          </ng-container>

          <!-- Sub Section (s2) -->
          <verse-section 
            *ngIf="text.tag === 's2'" 
            [data]="getDataForSection(i)"
            [changeLine]="chapterNumberIndex !== i && data.text[i-1].type !== 'section'">
          </verse-section>
        </ng-container>

      </ng-container>
      <!-- Quote Text -->
      <span *ngIf="text.type === 'quote'" class="quote">
        <div></div>
        <span #quote [ngClass]="{'indent': !checkIfIsTouchingChapterNumber(quote)}">
          {{ text.text }}
        </span>
      </span>
    </span>
  </ng-container>
</ng-container>